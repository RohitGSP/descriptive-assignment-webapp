<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Upload Answer Sheet</title>
</head>
<body>

<h1>Upload Your Answer Sheet</h1>

<!-- ============================================================
 STEP 1: Assignment Selection Form (Auto-refresh to show question)
=============================================================== -->
<form method="POST" action="/">
    <!-- Pass all user details back so they are preserved -->
    <input type="hidden" name="name" value="{{ name }}">
    <input type="hidden" name="mobile" value="{{ mobile }}">
    <input type="hidden" name="email" value="{{ email }}">
    <input type="hidden" name="category" value="{{ category }}">
    <input type="hidden" name="language" value="{{ language }}">

    <label>Select Assignment:</label><br>
    <select name="assignment_select" required onchange="this.form.submit()">
        <option value="">-- Select Assignment --</option>
        {% for a in assignments %}
        <option value="{{ a }}" {% if selected_assignment == a %}selected{% endif %}>
            {{ a }}
        </option>
        {% endfor %}
    </select>
</form>

<br><hr><br>

<!-- ============================================================
 STEP 2: Show Question Once Assignment Is Selected
=============================================================== -->
{% if question_display %}
<div style="border:1px solid #999; padding:12px; background:#f9f9f9;">
    <h3>ðŸ“˜ Question:</h3>
    <pre style="white-space:pre-wrap; font-family:inherit;">
{{ question_display }}
    </pre>
</div>
{% endif %}

<br>

<!-- ============================================================
 STEP 3: Show Upload Form ONLY AFTER Assignment Is Chosen
=============================================================== -->
{% if selected_assignment %}
<form method="post" action="/submit" enctype="multipart/form-data">

    <!-- Hidden fields needed for /submit -->
    <input type="hidden" name="name" value="{{ name }}">
    <input type="hidden" name="mobile" value="{{ mobile }}">
    <input type="hidden" name="email" value="{{ email }}">
    <input type="hidden" name="category" value="{{ category }}">
    <input type="hidden" name="language" value="{{ language }}">

    <!-- Pass the selected assignment -->
    <input type="hidden" name="assignment" value="{{ selected_assignment }}">

    <label>Upload File:</label><br>
    <input type="file" name="file" accept=".pdf,image/*" required><br><br>

    <button type="submit">Submit & Evaluate</button>

</form>
{% endif %}

</body>
</html>
